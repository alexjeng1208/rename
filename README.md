# 檔案重新命名工具

## 功能說明

這是一個專為檔案重新命名設計的GUI工具，支援兩種命名規則，並提供拖放功能和圖片/影片預覽功能。

### 1. Character規則（輸出給客戶端）
格式：`Character_{角色編號}_{類型}_{索引}.mp4`

- **類型**：
  - `Idle` = 預備演出
  - `Intro` = 開獎前演出
  - `Open` = 開獎演出

- **索引**：
  - Idle/Intro：可選擇01-20（固定選項）
  - Open：使用顏色索引（00-06）
    - 00 = 沒穿
    - 01 = 黑色
    - 02 = 白色
    - 03 = 綠色
    - 04 = 紅色
    - 05 = 黃色
    - 06 = 藍色

### 2. 夢想命名規則（內部規則，供員工瀏覽）

#### 醫院主題 (Hospital)
- H_Girlfriend
- H_Sister
- H_Cute
- H_Cool
- H_Motherly

#### SM主題 (BDSM)
- SM_Sister
- SM_Girlfriend

#### 臥室主題 (Bedroom)
- B_Cute_G
- B_Sister
- B_Cool_G
- B_M

#### 動漫主題 (Anime)
- A_{編號}

## 主要功能

### 基本功能
1. **批量選擇檔案**：支援選擇多個檔案或整個資料夾
2. **拖放功能**：可以直接拖放檔案或資料夾到視窗（需要安裝tkinterdnd2）
3. **調整順序**：可以上移、下移檔案順序
4. **一鍵設定類型**：快速將所有檔案設為Idle/Intro/Open
5. **定位20個人物模式**：為每個檔案設定不同的角色編號（01-20）
6. **預覽功能**：
   - **文字預覽**：顯示原檔名和新檔名的對應關係
   - **圖片/影片預覽**：顯示圖片縮圖和影片標記，方便確認檔案
7. **錯誤處理**：遇到檔案衝突時，可選擇覆蓋、跳過或取消
8. **索引固定選項**：索引改為下拉選單，無需手動輸入

### 新增功能（v2.0.0）

#### 1. 鍵盤快捷鍵支援
- `Ctrl+O` - 選擇檔案
- `Ctrl+D` - 選擇資料夾
- `Delete` - 刪除選中項目
- `Ctrl+F` - 聚焦到搜尋框
- `Ctrl+Z` - 撤銷重命名
- `Ctrl+R` - 預覽重新命名
- `Ctrl+Enter` - 執行重新命名
- `Ctrl+T` - 切換深色模式

#### 2. 設定檔記憶功能
- 自動記住最後使用的命名規則設定
- 記住角色編號、類型、索引等參數
- 記住視窗大小和位置
- 記住最大檔案數限制
- 記住深色模式偏好
- 配置保存在 `~/.file_renamer/config.json`

#### 3. 撤銷重命名功能
- 支援撤銷最後一次重命名操作
- 使用 `Ctrl+Z` 快捷鍵
- 記錄重命名歷史，支援查看和還原
- 歷史記錄保存在 `~/.file_renamer/history.json`

#### 4. 檔案搜尋過濾功能
- 在檔案列表中添加搜尋框
- 實時過濾檔案列表
- 顯示過濾結果數量（例如：20/50）
- 支援 `Ctrl+F` 快捷鍵聚焦搜尋框

#### 5. 進度條和視覺回饋
- 執行重命名時顯示進度條
- 顯示處理進度（例如：5/20）
- 按鈕上顯示快捷鍵提示
- 工具提示（Tooltip）功能

#### 6. 深色模式支援
- 支援淺色/深色主題切換
- 使用 `Ctrl+T` 快捷鍵切換
- 自動保存深色模式偏好
- 更新所有UI元件顏色

#### 7. 限制選擇數量功能
- 可設定最大選擇數量（0=無限制）
- 超過限制時會顯示警告
- 只添加允許的數量
- 顯示當前數量

#### 8. 資料夾路徑導入
- 支援直接輸入資料夾路徑並導入
- 支援拖放資料夾到視窗
- 自動掃描資料夾內的支援檔案

#### 9. 僅處理選中項功能
- 可選擇僅處理選中的檔案
- 多選時按順序自動排序命名
- 索引從01開始遞增

## 支援的檔案格式

- MP4（影片）
- JPG（圖片）
- PNG（圖片）

## 使用說明

### 基本使用

1. **啟動程式**：
   - Python環境：執行 `file_renamer.py`
   - EXE版本：雙擊 `檔案重新命名工具.exe`

2. **選擇檔案**：
   - 點擊「選擇檔案」或「選擇資料夾」
   - **或直接拖放檔案/資料夾**到視窗（需要安裝tkinterdnd2）
   - **或輸入資料夾路徑**並點擊「導入」

3. **設定限制數量**（可選）：
   - 在「最大選擇數量」輸入框中設定最大檔案數（0=無限制）
   - 超過限制時會顯示警告

4. **選擇命名規則**：選擇Character規則或夢想命名規則

5. **設定參數**：根據選擇的規則設定相應參數
   - 索引改為下拉選單，直接選擇即可
   - 選項改變時預覽會自動刷新

6. **搜尋檔案**（可選）：
   - 在搜尋框中輸入關鍵字
   - 檔案列表會實時過濾
   - 使用 `Ctrl+F` 快速聚焦搜尋框

7. **僅處理選中項**（可選）：
   - 勾選「僅處理選中的檔案」
   - 多選檔案後，會按選中順序自動排序命名

8. **預覽結果**：
   - 點擊「預覽重新命名 (Ctrl+R)」查看結果
   - 切換「文字預覽」和「圖片/影片預覽」標籤頁查看不同預覽方式

9. **執行重新命名**：
   - 確認無誤後點擊「執行重新命名 (Ctrl+Enter)」
   - 會顯示進度條和處理進度
   - 完成後顯示結果

10. **撤銷操作**（可選）：
    - 如果需要撤銷，點擊「撤銷 (Ctrl+Z)」
    - 只能撤銷最後一次操作

### 快捷鍵使用

所有快捷鍵都會在按鈕上顯示，懸停按鈕可查看工具提示。

### 深色模式

- 使用 `Ctrl+T` 切換深色/淺色模式
- 設定會自動保存
- 下次啟動時會自動應用

## 打包成EXE

詳細說明請參考 `打包說明.md` 檔案。

快速打包：
1. 雙擊執行 `build_exe.bat`
2. 等待打包完成
3. EXE檔案在 `dist` 資料夾中

### 打包配置

已更新打包配置，包含所有新模組：
- `config.py` - 配置管理模組
- `utils.py` - 工具函數模組

## 專案結構

```
file_renamer_tool/
├── file_renamer.py      # 主程式檔案
├── config.py            # 配置管理模組
├── utils.py             # 工具函數模組
├── build_exe.bat        # 打包批處理檔案
├── build_exe.spec       # PyInstaller配置檔案
├── 檔案重新命名工具.spec  # PyInstaller配置檔案
├── requirements.txt     # 依賴套件列表
├── README.md           # 說明文件
└── 打包說明.md          # 打包說明文件
```

## 配置檔案位置

- **Windows**: `C:\Users\你的用戶名\.file_renamer\`
- **Linux/Mac**: `~/.file_renamer/`

配置檔案：
- `config.json` - 應用設定
- `history.json` - 重命名歷史記錄（最多1000筆）

## 注意事項

- **tkinter**：Python內建模組，如果系統未安裝，請在安裝Python時選擇包含tkinter的選項
- **tkinterdnd2**：用於拖放功能，如果未安裝，拖放功能將不可用（但不影響其他功能）
- **Pillow**：用於圖片預覽功能，如果未安裝，圖片預覽將受限（但不影響其他功能）
- 索引改為固定選項（01-20），無需手動輸入
- 選項改變時預覽會自動刷新
- 執行重新命名前請先預覽結果
- 遇到檔案衝突時，可選擇覆蓋、跳過或取消操作
- 撤銷功能只能撤銷最後一次操作
- 歷史記錄最多保存1000筆

## 系統需求

### Python環境版本
- Python 3.6 或更高版本
- tkinter（Python內建模組）
- tkinterdnd2（可選，用於拖放功能）：`pip install tkinterdnd2`
- Pillow（可選，用於圖片預覽）：`pip install Pillow`

### EXE版本
- Windows 10 或更高版本
- 無需安裝Python，可直接執行EXE檔案

## 更新日誌

### v2.0.0
- ✨ 新增鍵盤快捷鍵支援
- ✨ 新增設定檔記憶功能
- ✨ 新增撤銷重命名功能
- ✨ 新增檔案搜尋過濾功能
- ✨ 新增進度條和視覺回饋
- ✨ 新增深色模式支援
- ✨ 新增限制選擇數量功能
- ✨ 新增資料夾路徑導入功能
- ✨ 新增僅處理選中項功能
- 🔧 索引改為固定選項（下拉選單）
- 🔧 選項改變時自動刷新預覽
- 🔧 程式碼重構為模組化結構
- 📝 所有文字改為繁體中文

### v1.0.0
- 初始版本
- 基本檔案重新命名功能
- 支援兩種命名規則
- 拖放功能
- 圖片/影片預覽功能

## 授權

本專案為開源專案，可自由使用和修改。
