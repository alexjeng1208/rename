# 檔案重新命名工具 - 用戶操作手冊

## 📋 目錄

1. [快速開始](#快速開始)
2. [界面介紹](#界面介紹)
3. [基本操作](#基本操作)
4. [命名規則詳解](#命名規則詳解)
5. [進階功能](#進階功能)
6. [鍵盤快捷鍵](#鍵盤快捷鍵)
7. [常見問題](#常見問題)
8. [注意事項](#注意事項)

---

## 🚀 快速開始

### 啟動程式

1. **開發環境**：
   ```bash
   python file_renamer.py
   ```

2. **EXE版本**：
   - 雙擊 `檔案重新命名工具.exe`

### 第一次使用

1. 點擊「選擇檔案」或「選擇資料夾」
2. 選擇要重新命名的檔案
3. 選擇命名規則（Character 或 Dream）
4. 設定參數（編號、類型、索引等）
5. 查看預覽確認
6. 點擊「執行重新命名」

---

## 🖥️ 界面介紹

### 主界面佈局

```
┌─────────────────────────────────────────────────────────────┐
│  命名規則選擇區                                              │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ ● Character規則  ○ Dream規則                        │   │
│  └─────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│  參數設定區                                                  │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 角色編號: [01▼]  類型: [Idle▼]  索引: [01▼]         │   │
│  └─────────────────────────────────────────────────────┘   │
├──────────────────────┬──────────────────────────────────────┤
│  檔案列表區          │  預覽區                              │
│  ┌──────────────┐   │  ┌──────────────────────────────┐   │
│  │ file1.jpg    │   │  │  [圖片預覽]                  │   │
│  │ file2.jpg    │   │  │                              │   │
│  │ file3.mp4    │   │  │  原檔名: file1.jpg           │   │
│  └──────────────┘   │  │  新檔名: Character_01...     │   │
│                      │  └──────────────────────────────┘   │
├──────────────────────┴──────────────────────────────────────┤
│  文本預覽區                                                  │
│  ┌─────────────────────────────────────────────────────┐   │
│  │ 原檔名: file1.jpg                                    │   │
│  │ 新檔名: Character_01_Idle_01.jpg ✓                  │   │
│  │ ...                                                  │   │
│  └─────────────────────────────────────────────────────┘   │
├─────────────────────────────────────────────────────────────┤
│  操作按鈕區                                                  │
│  [ 執行重新命名 ]  [ 撤銷 ]  [ 清除 ]                       │
└─────────────────────────────────────────────────────────────┘
```

### 界面元素說明

#### 1. **命名規則選擇區**
- **Character規則**：對外格式，用於客戶端
- **Dream規則**：內部格式，用於員工瀏覽

#### 2. **參數設定區**
根據選擇的規則顯示不同的參數選項

#### 3. **檔案列表區**
- 顯示已選擇的所有檔案
- 支持多選（Ctrl+點擊）
- 支持拖放添加檔案

#### 4. **圖片預覽區**
- 顯示當前選中檔案的圖片預覽
- 顯示原檔名和新檔名
- 實時更新參數變化

#### 5. **文本預覽區**
- 顯示所有檔案的重命名預覽
- 顯示驗證狀態（✓ 或 ✗）
- 顯示錯誤信息（如有）

---

## 📖 基本操作

### 1. 添加檔案

#### 方法一：點擊按鈕
1. 點擊「選擇檔案」按鈕
2. 在彈出的對話框中選擇檔案
3. 點擊「開啟」

#### 方法二：選擇資料夾
1. 點擊「選擇資料夾」按鈕
2. 選擇包含檔案的資料夾
3. 程式會自動添加資料夾中所有支援的檔案

#### 方法三：拖放（推薦）
1. 從檔案管理器選擇檔案或資料夾
2. 直接拖放到程式視窗中
3. 自動添加到檔案列表

#### 支援的檔案格式
- **圖片**：`.jpg`, `.jpeg`, `.png`
- **影片**：`.mp4`

### 2. 管理檔案列表

#### 調整順序
- **上移**：選中檔案 → 點擊「⬆」按鈕
- **下移**：選中檔案 → 點擊「⬇」按鈕

#### 刪除檔案
- **方法1**：選中檔案 → 點擊「移除選中」
- **方法2**：選中檔案 → 按 `Delete` 鍵

#### 清空列表
- 點擊「清除」按鈕

#### 搜尋檔案
1. 在搜尋框輸入關鍵字
2. 列表自動篩選匹配的檔案
3. 清空搜尋框恢復完整列表

### 3. 查看預覽

#### 圖片預覽
1. 點擊檔案列表中的任一檔案
2. 右側預覽區顯示：
   - 圖片縮圖（或影片標記）
   - 原檔名
   - 新檔名（實時更新）

#### 文本預覽
- 底部區域顯示所有檔案的重命名對照表
- 包含驗證狀態和詳細信息

### 4. 執行重新命名

1. 確認預覽無誤
2. 點擊「執行重新命名」按鈕
3. 確認操作（如有提示）
4. 等待處理完成
5. 查看成功提示

#### 處理衝突
如果目標檔名已存在，程式會詢問：
- **是**：覆蓋現有檔案
- **否**：跳過此檔案
- **取消**：取消所有操作

### 5. 撤銷操作

1. 點擊「撤銷」按鈕
2. 最近一次的重命名操作將被還原
3. 可以連續撤銷多次操作

---

## 🎯 命名規則詳解

### Character規則（對外格式）

#### 格式
```
Character_{角色編號}_{類型}_{索引}.ext
```

#### 參數說明

##### 1. 角色編號（01-99）
- 範圍：01 到 99
- 格式：兩位數字，自動補零
- 示例：01, 02, 10, 99

##### 2. 類型（三選一）
- **Idle**：預備演出
- **Intro**：開獎前演出
- **Open**：開獎演出

##### 3. 索引（依類型而定）

**Idle / Intro 類型**：
- 範圍：01-20
- 固定選項下拉選單
- 示例：
  - `Character_01_Idle_01.mp4`
  - `Character_01_Idle_05.mp4`
  - `Character_01_Intro_10.mp4`

**Open 類型**：
- 使用顏色索引（00-06）
- 下拉選單顯示：
  ```
  01 - 沒穿
  02 - 黑色
  03 - 白色
  04 - 綠色
  05 - 紅色
  06 - 黃色
  07 - 藍色
  ```
- 實際存儲為對應的編號（00-06）
- 示例：
  - `Character_01_Open_00.mp4` （沒穿）
  - `Character_01_Open_01.mp4` （黑色）

#### 完整示例

```
Character_01_Idle_01.mp4    ✓ 正確
Character_05_Intro_10.jpg   ✓ 正確
Character_10_Open_03.mp4    ✓ 正確

Character_1_Idle_01.mp4     ✗ 錯誤（編號應為兩位）
Character_01_idle_01.mp4    ✗ 錯誤（類型大小寫錯誤）
Character_01_Idle_1.mp4     ✗ 錯誤（索引應為兩位）
```

### Dream規則（內部格式）

#### 主題選擇

##### 1. Hospital（醫院主題）
- H_Girlfriend
- H_Sister
- H_Cute
- H_Cool
- H_Motherly

格式：`H_Girlfriend_01.mp4`

##### 2. BDSM主題
- SM_Sister
- SM_Girlfriend

格式：`SM_Sister_01.mp4`

##### 3. Bedroom（臥室主題）
- B_Cute_G
- B_Sister
- B_Cool_G
- B_M

格式：`B_Cute_G_01.mp4`

##### 4. Anime（動漫主題）
- A_編號

格式：`A_01.mp4`

#### 參數設定

1. **選擇主題**：從下拉選單選擇
2. **選擇角色**：根據主題顯示對應角色
3. **設定索引**：01-99

---

## 🎨 進階功能

### 1. 僅處理選中的檔案

#### 功能說明
- 只重命名選中的檔案，忽略未選中的
- 選中的檔案按順序自動排序命名

#### 使用方法
1. 在檔案列表中選中要處理的檔案
   - 單選：點擊檔案
   - 多選：按住 `Ctrl` 點擊多個檔案
2. 勾選「✓ 僅處理選中的檔案」
3. 查看預覽（只顯示選中檔案）
4. 執行重命名

#### 應用場景
- 只想重命名部分檔案
- 需要跳過某些檔案
- 特定檔案需要特殊處理

### 2. 一鍵設定類型（Character規則）

#### 功能說明
快速將所有檔案設為同一類型

#### 使用方法
1. 在參數設定區找到「一鍵設定」按鈕
2. 點擊對應按鈕：
   - **Idle**：所有檔案設為 Idle 類型
   - **Intro**：所有檔案設為 Intro 類型
   - **Open**：所有檔案設為 Open 類型
3. 預覽自動更新

#### 應用場景
- 批量處理同類型檔案
- 快速切換類型進行比較

### 3. 定位20個人物模式（Character規則）

#### 功能說明
為前20個檔案自動分配不同的角色編號（01-20）

#### 使用方法
1. 添加至少20個檔案到列表
2. 點擊「定位20個人物」按鈕
3. 程式自動為檔案分配編號：
   - 第1個檔案 → 角色編號 01
   - 第2個檔案 → 角色編號 02
   - ...
   - 第20個檔案 → 角色編號 20
4. 查看預覽確認

#### 應用場景
- 製作角色展示視頻
- 批量處理多角色資源

### 4. 檔案數量限制

#### 功能說明
限制可添加的最大檔案數量，防止意外添加過多檔案

#### 使用方法
1. 在設定中找到「檔案數量限制」
2. 輸入最大數量（0 表示不限制）
3. 超過限制時會顯示警告

### 5. 深色模式

#### 切換方法
- **方法1**：點擊界面右上角的主題切換按鈕
- **方法2**：按 `Ctrl+T` 快捷鍵

#### 自動保存
- 程式會記住您的主題偏好
- 下次啟動時自動應用

### 6. 設定記憶

#### 功能說明
程式會自動保存您的設定，下次啟動時恢復

#### 保存的設定
- 視窗大小和位置
- 命名規則選擇
- 參數設定（編號、類型、索引等）
- 主題偏好
- 檔案數量限制
- 上次使用的資料夾路徑

---

## ⌨️ 鍵盤快捷鍵

| 快捷鍵 | 功能 | 說明 |
|--------|------|------|
| `Ctrl+O` | 選擇檔案 | 打開檔案選擇對話框 |
| `Ctrl+D` | 選擇資料夾 | 打開資料夾選擇對話框 |
| `Ctrl+F` | 搜尋 | 聚焦到搜尋框 |
| `Ctrl+R` | 預覽 | 更新預覽 |
| `Ctrl+Enter` | 執行重新命名 | 開始重命名操作 |
| `Ctrl+Z` | 撤銷 | 撤銷上一次重命名 |
| `Ctrl+T` | 切換主題 | 切換深色/淺色模式 |
| `Delete` | 刪除選中 | 從列表移除選中檔案 |
| `Esc` | 取消 | 取消當前操作 |

---

## ❓ 常見問題

### Q1: 預覽顯示正確，但執行後檔名不對？

**原因**：可能是在執行前又修改了參數

**解決方法**：
1. 修改參數後先查看預覽
2. 確認無誤後立即執行
3. 不要在執行過程中修改參數

### Q2: 為什麼有些檔案無法添加？

**原因**：檔案格式不支援

**支援的格式**：
- 圖片：`.jpg`, `.jpeg`, `.png`
- 影片：`.mp4`

**解決方法**：
- 確認檔案擴展名正確
- 轉換不支援的格式

### Q3: 圖片預覽為什麼不顯示？

**可能原因**：
1. 圖片檔案損壞
2. 圖片格式特殊
3. 檔案太大載入慢

**解決方法**：
1. 檢查圖片是否能正常開啟
2. 等待載入完成（會顯示「載入中...」）
3. 即使預覽不顯示，重命名功能仍可正常使用

### Q4: 執行重命名時出現檔案衝突怎麼辦？

**選項說明**：
- **是**：覆蓋現有檔案（請謹慎選擇）
- **否**：跳過此檔案，繼續處理其他檔案
- **取消**：停止所有操作

**建議**：
- 先備份原始檔案
- 選擇「否」跳過衝突檔案
- 手動處理衝突檔案

### Q5: 撤銷操作無法執行？

**可能原因**：
1. 沒有可撤銷的操作
2. 原始檔案已被移動或刪除
3. 目標位置沒有寫入權限

**解決方法**：
- 確認確實執行過重命名操作
- 檢查檔案是否還在原位置
- 確認有足夠的檔案系統權限

### Q6: Open類型的顏色索引和顯示的不一致？

**說明**：這是正常的！

- **顯示**：01-07（方便理解）
- **實際**：00-06（符合程式規範）
- **對應關係**：
  ```
  顯示01（沒穿）→ 存儲00
  顯示02（黑色）→ 存儲01
  ...
  顯示07（藍色）→ 存儲06
  ```

### Q7: 程式啟動很慢？

**可能原因**：
1. 首次啟動需要載入設定
2. 上次未正確關閉
3. 系統資源不足

**解決方法**：
1. 耐心等待首次載入
2. 正確關閉程式（點擊 X 按鈕）
3. 關閉其他佔用資源的程式

### Q8: 如何批量處理大量檔案？

**建議方法**：
1. 分批處理（每批100個以內）
2. 使用「僅處理選中的檔案」功能
3. 按類型分類處理
4. 定期保存進度（通過撤銷功能確認）

---

## ⚠️ 注意事項

### 使用前

1. **備份重要檔案**
   - 建議先備份原始檔案
   - 重命名操作可撤銷，但覆蓋無法恢復

2. **檢查檔案格式**
   - 確認所有檔案格式支援
   - 不支援的格式不會被添加

3. **確認目標資料夾權限**
   - 確保有寫入權限
   - 避免在系統資料夾操作

### 使用中

1. **仔細查看預覽**
   - 圖片預覽：確認檔案正確
   - 文本預覽：確認命名無誤
   - 驗證狀態：注意 ✗ 標記

2. **注意驗證錯誤**
   - 紅色 ✗ 表示格式不符合規範
   - 查看錯誤提示信息
   - 修正參數後重新預覽

3. **避免重複命名**
   - 同一資料夾中避免相同檔名
   - 注意檔案衝突提示

### 使用後

1. **驗證結果**
   - 檢查重命名後的檔案
   - 確認數量和順序正確
   - 測試檔案是否可正常使用

2. **保留原始備份**
   - 至少保留備份一段時間
   - 確認無誤後再刪除備份

3. **記錄操作**
   - 程式會自動記錄歷史
   - 可通過撤銷查看最近操作

---

## 🔧 故障排除

### 程式無法啟動

1. 檢查 Python 版本（需要 3.7+）
2. 安裝必要的依賴：
   ```bash
   pip install pillow tkinterdnd2
   ```
3. 檢查系統權限

### 功能異常

1. **重新啟動程式**
2. **檢查配置檔案**：
   - 位置：`~/.file_renamer/config.json`
   - 可刪除此檔案重置設定
3. **查看錯誤日誌**（開發環境）

### 性能問題

1. **減少檔案數量**
2. **關閉不必要的預覽**
3. **清理歷史記錄**

---

## 📞 技術支持

### 問題回報

如遇到問題，請提供：
1. 操作步驟
2. 錯誤提示（如有）
3. 截圖（如有）
4. 系統環境信息

### 版本信息

- **當前版本**：v2.0.0
- **更新日期**：2024-11
- **支援系統**：Windows 10+

---

## 📝 版本歷史

### v2.0.0（當前版本）
- ✅ 新增實時預覽更新功能
- ✅ 修復參數切換時預覽消失問題
- ✅ 增強異步加載並發控制
- ✅ 新增詳細的調試日誌
- ✅ 完善錯誤處理和降級顯示
- ✅ 新增多項快捷鍵支持
- ✅ 優化UI滾動功能
- ✅ 增強安全性和驗證功能

### v1.0.0
- 初始版本
- 基本重命名功能
- Character和Dream兩種規則

---

## 🎓 使用技巧

### 提高效率

1. **使用拖放**：最快的添加檔案方式
2. **使用快捷鍵**：熟記常用快捷鍵
3. **批量操作**：善用「一鍵設定」功能
4. **預設值**：設定常用的預設參數

### 避免錯誤

1. **先預覽後執行**：每次都檢查預覽
2. **小批量測試**：先處理少量檔案測試
3. **定期備份**：重要檔案務必備份
4. **注意驗證**：留意 ✗ 標記的錯誤

### 工作流程建議

```
1. 備份檔案
   ↓
2. 添加檔案到程式
   ↓
3. 選擇命名規則
   ↓
4. 設定參數
   ↓
5. 查看預覽（圖片+文本）
   ↓
6. 確認無誤
   ↓
7. 執行重新命名
   ↓
8. 驗證結果
   ↓
9. 保留備份至確認無誤
```

---

## ✨ 結語

感謝您使用檔案重新命名工具！

如有任何問題或建議，歡迎反饋。祝您使用愉快！

**最後更新**：2024-11-10
**版本**：v2.0.0

