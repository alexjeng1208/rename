# 檔案重新命名工具 v2.0 🎉

## ✨ v2.0 新功能

**重大更新！v2.0 版本帶來全面優化的使用體驗：**

### 🎯 核心改進
- ✅ **模組化架構** - 程式碼重構，更易維護和擴展
- ⌨️ **鍵盤快捷鍵** - 支援 Ctrl+O、Ctrl+Z、Delete 等快捷鍵
- 💾 **設定記憶** - 自動記住最後使用的資料夾和命名規則
- ↩️ **撤銷功能** - 支援重命名後的撤銷操作
- 🔍 **檔案搜尋** - 快速過濾和搜尋檔案列表
- 📊 **狀態列** - 即時顯示操作狀態和檔案統計
- 💡 **工具提示** - 滑鼠懸停顯示功能說明
- 🌙 **深色模式** - 支援淺色/深色主題切換（基礎版）
- 📋 **選單列** - 完整的選單系統，操作更直觀

### 🎨 介面優化
- 更友善的工具列佈局
- 更清晰的視覺回饋
- 改進的預覽功能
- 居中對齊的預覽圖片

## 功能說明

這是一個專為檔案重新命名設計的GUI工具，支援兩種命名規則，並提供拖放功能和圖片/影片預覽功能。

### 版本選擇
- **v2.0 優化版**：`file_renamer_v2.py` - 推薦使用，功能更完整
- **v1.0 原版本**：`file_renamer.py` - 保留供參考

### 1. Character規則（輸出給客戶端）
格式：`Character_{角色編號}_{類型}_{索引}.mp4`

- **類型**：
  - `Idle` = 預備演出
  - `Intro` = 開獎前演出
  - `Open` = 開獎演出

- **索引**：
  - Idle/Intro：可輸入任意數字（超過20會顯示警告）
  - Open：使用顏色索引（00-06）
    - 00 = 沒穿
    - 01 = 黑色
    - 02 = 白色
    - 03 = 綠色
    - 04 = 紅色
    - 05 = 黃色
    - 06 = 藍色

### 2. 夢想命名規則（內部規則，供員工瀏覽）

#### 醫院主題 (Hospital)
- H_Girlfriend
- H_Sister
- H_Cute
- H_Cool
- H_Motherly

#### SM主題 (BDSM)
- SM_Sister
- SM_Girlfriend

#### 臥室主題 (Bedroom)
- B_Cute_G
- B_Sister
- B_Cool_G
- B_M

#### 動漫主題 (Anime)
- A_{編號}

## 主要功能

1. **批量選擇檔案**：支援選擇多個檔案或整個資料夾
2. **拖放功能**：可以直接拖放檔案到視窗（需要安裝tkinterdnd2）
3. **調整順序**：可以上移、下移檔案順序
4. **一鍵設定類型**：快速將所有檔案設為Idle/Intro/Open
5. **定位20個人物模式**：為每個檔案設定不同的角色編號（01-20）
6. **預覽功能**：
   - **文字預覽**：顯示原檔名和新檔名的對應關係
   - **圖片/影片預覽**：顯示圖片縮圖和影片標記，方便確認檔案
7. **錯誤處理**：遇到檔案衝突時，可選擇覆蓋、跳過或取消
8. **索引警告**：當索引超過20時會顯示警告提示

## 支援的檔案格式

- MP4（影片）
- JPG（圖片）
- PNG（圖片）

## ⌨️ 鍵盤快捷鍵（v2.0 新增）

| 功能 | 快捷鍵 |
|------|--------|
| 選擇檔案 | `Ctrl + O` |
| 選擇資料夾 | `Ctrl + Shift + O` |
| 清空列表 | `Ctrl + L` |
| 刪除選中的檔案 | `Delete` |
| 撤銷重命名 | `Ctrl + Z` |
| 搜尋檔案 | `Ctrl + F` |
| 上移檔案 | `Ctrl + ↑` |
| 下移檔案 | `Ctrl + ↓` |
| 預覽重新命名 | `Ctrl + P` |
| 執行重新命名 | `Ctrl + Enter` |
| 切換深色模式 | `Ctrl + T` |
| 儲存設定 | `Ctrl + S` |
| 快捷鍵說明 | `F1` |

## 使用說明

1. **啟動程式**：
   - **v2.0 版本（推薦）**：執行 `python file_renamer_v2.py` 或使用打包的 EXE
   - **v1.0 版本**：執行 `python file_renamer.py`
   - **EXE版本**：雙擊 `檔案重新命名工具_v2.exe`

2. **選擇檔案**：
   - 點擊「選擇檔案」或「選擇資料夾」
   - **或直接拖放檔案**到視窗（需要安裝tkinterdnd2）

3. **選擇命名規則**：選擇Character規則或夢想命名規則

4. **設定參數**：根據選擇的規則設定相應參數

5. **預覽結果**：
   - 點擊「預覽重新命名」查看結果
   - 切換「文字預覽」和「圖片/影片預覽」標籤頁查看不同預覽方式

6. **執行重新命名**：確認無誤後點擊「執行重新命名」

## 打包成EXE

詳細說明請參考 `打包說明.md` 檔案。

快速打包：
1. 雙擊執行 `build_exe.bat`
2. 等待打包完成
3. EXE檔案在 `dist` 資料夾中

## 注意事項

### v2.0 新增功能注意事項
- **設定檔案**：程式會自動在當前目錄建立 `renamer_settings.json`（設定）和 `rename_history.json`（歷史記錄）
- **撤銷功能**：重命名操作會記錄到歷史，支援撤銷（需要原檔案仍在原位置）
- **快捷鍵**：按 `F1` 可查看所有可用的快捷鍵
- **搜尋功能**：按 `Ctrl+F` 可快速搜尋檔案列表
- **自動儲存**：關閉程式時會自動儲存當前設定

### 一般注意事項
- **tkinter**：Python內建模組，如果系統未安裝，請在安裝Python時選擇包含tkinter的選項
- **tkinterdnd2**：用於拖放功能，如果未安裝，拖放功能將不可用（但不影響其他功能）
- **Pillow**：用於圖片預覽功能，如果未安裝，圖片預覽將受限（但不影響其他功能）
- 索引超過20時會顯示警告，請確認是否正確
- 執行重新命名前請先預覽結果
- 遇到檔案衝突時，可選擇覆蓋、跳過或取消操作

## 系統需求

### Python環境版本
- Python 3.6 或更高版本
- tkinter（Python內建模組）
- tkinterdnd2（可選，用於拖放功能）：`pip install tkinterdnd2`
- Pillow（可選，用於圖片預覽）：`pip install Pillow`

### EXE版本
- Windows 10 或更高版本
- 無需安裝Python，可直接執行EXE檔案

