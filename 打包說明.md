# 打包成EXE說明

## 方法一：使用批次檔（推薦）

1. 雙擊執行 `build_exe.bat`
2. 等待打包完成
3. EXE檔案會在 `dist` 資料夾中

## 方法二：使用PyInstaller命令

### 1. 安裝依賴套件

```bash
pip install -r requirements.txt
```

或手動安裝：

```bash
pip install pyinstaller tkinterdnd2 Pillow
```

### 2. 打包成EXE

```bash
pyinstaller --name="檔案重新命名工具" --onefile --windowed file_renamer.py
```

### 3. 完整打包命令（包含所有依賴）

```bash
pyinstaller --name="檔案重新命名工具" ^
    --onefile ^
    --windowed ^
    --hidden-import=tkinterdnd2 ^
    --hidden-import=PIL ^
    --hidden-import=PIL.Image ^
    --hidden-import=PIL.ImageTk ^
    --collect-all tkinterdnd2 ^
    --collect-all PIL ^
    file_renamer.py
```

### 4. 使用spec檔案打包

```bash
pyinstaller build_exe.spec
```

## 打包選項說明

- `--onefile`: 打包成單一EXE檔案
- `--windowed`: 不顯示控制台視窗（GUI應用）
- `--name`: 指定EXE檔案名稱
- `--hidden-import`: 指定需要隱式匯入的模組
- `--collect-all`: 收集所有相關的資料檔案

## 注意事項

1. **tkinterdnd2**: 如果打包後拖放功能無法使用，可能需要手動複製tkinterdnd2的DLL檔案
2. **Pillow**: 確保Pillow已正確安裝，否則圖片預覽功能可能無法使用
3. **檔案大小**: 打包後的EXE檔案可能會比較大（約50-100MB），這是正常的，因為包含了Python運行環境

## 測試EXE

打包完成後，請測試以下功能：

1. ✅ 雙擊EXE檔案可以正常啟動
2. ✅ 選擇檔案功能正常
3. ✅ 拖放檔案功能正常（如果已安裝tkinterdnd2）
4. ✅ 預覽功能正常（文字和圖片）
5. ✅ 重新命名功能正常

## 問題排除

### 問題1：拖放功能無法使用

**解決方案**：
- 確保tkinterdnd2已正確安裝
- 在打包時使用 `--collect-all tkinterdnd2` 選項
- 檢查是否有DLL檔案缺失

### 問題2：圖片預覽無法顯示

**解決方案**：
- 確保Pillow已正確安裝
- 在打包時使用 `--collect-all PIL` 選項
- 檢查圖片檔案格式是否支援

### 問題3：EXE檔案無法啟動

**解決方案**：
- 檢查是否有防毒軟體阻擋
- 嘗試使用 `--console` 選項查看錯誤訊息
- 檢查是否有缺少的依賴套件

## 分發EXE

打包完成後，可以將 `dist\檔案重新命名工具.exe` 分發給其他使用者。

**注意**：
- EXE檔案是獨立的，不需要安裝Python
- 但需要確保目標電腦的Windows系統版本相容
- 建議在Windows 10或更高版本上測試

