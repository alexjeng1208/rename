# 檔案重新命名工具

## 功能說明

這是一個專為檔案重新命名設計的GUI工具，支援兩種命名規則，並提供拖放功能和圖片/影片預覽功能。

### 1. Character規則（輸出給客戶端）
格式：`Character_{角色編號}_{類型}_{索引}.mp4`

- **類型**：
  - `Idle` = 預備演出
  - `Intro` = 開獎前演出
  - `Open` = 開獎演出

- **索引**：
  - Idle/Intro：可輸入任意數字（超過20會顯示警告）
  - Open：使用顏色索引（00-06）
    - 00 = 沒穿
    - 01 = 黑色
    - 02 = 白色
    - 03 = 綠色
    - 04 = 紅色
    - 05 = 黃色
    - 06 = 藍色

### 2. 夢想命名規則（內部規則，供員工瀏覽）

#### 醫院主題 (Hospital)
- H_Girlfriend
- H_Sister
- H_Cute
- H_Cool
- H_Motherly

#### SM主題 (BDSM)
- SM_Sister
- SM_Girlfriend

#### 臥室主題 (Bedroom)
- B_Cute_G
- B_Sister
- B_Cool_G
- B_M

#### 動漫主題 (Anime)
- A_{編號}

## 主要功能

1. **批量選擇檔案**：支援選擇多個檔案或整個資料夾
2. **拖放功能**：可以直接拖放檔案到視窗（需要安裝tkinterdnd2）
3. **調整順序**：可以上移、下移檔案順序
4. **一鍵設定類型**：快速將所有檔案設為Idle/Intro/Open
5. **定位20個人物模式**：為每個檔案設定不同的角色編號（01-20）
6. **預覽功能**：
   - **文字預覽**：顯示原檔名和新檔名的對應關係
   - **圖片/影片預覽**：顯示圖片縮圖和影片標記，方便確認檔案
7. **錯誤處理**：遇到檔案衝突時，可選擇覆蓋、跳過或取消
8. **索引警告**：當索引超過20時會顯示警告提示

## 支援的檔案格式

- MP4（影片）
- JPG（圖片）
- PNG（圖片）

## 使用說明

1. **啟動程式**：
   - Python環境：執行 `file_renamer.py`
   - EXE版本：雙擊 `檔案重新命名工具.exe`

2. **選擇檔案**：
   - 點擊「選擇檔案」或「選擇資料夾」
   - **或直接拖放檔案**到視窗（需要安裝tkinterdnd2）

3. **選擇命名規則**：選擇Character規則或夢想命名規則

4. **設定參數**：根據選擇的規則設定相應參數

5. **預覽結果**：
   - 點擊「預覽重新命名」查看結果
   - 切換「文字預覽」和「圖片/影片預覽」標籤頁查看不同預覽方式

6. **執行重新命名**：確認無誤後點擊「執行重新命名」

## 打包成EXE

詳細說明請參考 `打包說明.md` 檔案。

快速打包：
1. 雙擊執行 `build_exe.bat`
2. 等待打包完成
3. EXE檔案在 `dist` 資料夾中

## 注意事項

- **tkinter**：Python內建模組，如果系統未安裝，請在安裝Python時選擇包含tkinter的選項
- **tkinterdnd2**：用於拖放功能，如果未安裝，拖放功能將不可用（但不影響其他功能）
- **Pillow**：用於圖片預覽功能，如果未安裝，圖片預覽將受限（但不影響其他功能）
- 索引超過20時會顯示警告，請確認是否正確
- 執行重新命名前請先預覽結果
- 遇到檔案衝突時，可選擇覆蓋、跳過或取消操作

## 系統需求

### Python環境版本
- Python 3.6 或更高版本
- tkinter（Python內建模組）
- tkinterdnd2（可選，用於拖放功能）：`pip install tkinterdnd2`
- Pillow（可選，用於圖片預覽）：`pip install Pillow`

### EXE版本
- Windows 10 或更高版本
- 無需安裝Python，可直接執行EXE檔案

